{"version":3,"sources":["../src/validators.ts","../src/utils.ts","../src/glsl-asset-manager.ts","../src/shaders.ts","../src/glsl-canvas.ts","../src/index.ts"],"names":["isNumber","value","isString","isBool","isVec2","isVec3","isVec4","isImageFile","fileName","imageExtensions","lowerCaseFileName","ext","isVideoFile","videoExtensions","getContext","canvas","gl","updateTexture","texture","TEXTURE_2D","RGBA","UNSIGNED_BYTE","pixel","setTextureParams","isPowerOf2","getUniformType","uniform","GlslAssetManager","program","initialUniforms","uniformPrefix","uTime","uRes","uMouse","uniforms","name","val","location","inferred","_name","uni","type","textureUnit","url","image","sizeName","sizeLocation","error","video","asset","unit","stream","txtr","src","track","glsl_asset_manager_default","vertexShaderSource","fragmentShaderSource","DEFAULT_VERTICES","GlslCanvas","container","frag","vertexShader","fragmentShader","a_Position","source","shader","data","buffer","rect","glsl_canvas_default","GlslRenderer","time","t","signal","event","clientX","clientY"],"mappings":"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","file":"index.js","sourcesContent":["import type { Vec2, Vec3, Vec4 } from \"./types\";\n\nfunction isNumber(value: unknown) {\n  return typeof value === \"number\";\n}\n\nfunction isString(value: unknown) {\n  return typeof value === \"string\";\n}\n\nfunction isBool(value: unknown) {\n  return typeof value === \"boolean\";\n}\n\nfunction isVec2(value: unknown): value is Vec2 {\n  return Array.isArray(value) && value.length === 2 && value.every(isNumber);\n}\n\nfunction isVec3(value: unknown): value is Vec3 {\n  return Array.isArray(value) && value.length === 3 && value.every(isNumber);\n}\n\nfunction isVec4(value: unknown): value is Vec4 {\n  return Array.isArray(value) && value.length === 4 && value.every(isNumber);\n}\n\nfunction isImageFile(fileName: string): boolean {\n  const imageExtensions = [\n    \".jpg\",\n    \".jpeg\",\n    \".png\",\n    \".gif\",\n    \".bmp\",\n    \".webp\",\n    \".svg\",\n    \".tiff\",\n    \".ico\",\n  ];\n  const lowerCaseFileName = fileName.toLowerCase();\n\n  return imageExtensions.some((ext) => lowerCaseFileName.endsWith(ext));\n}\n\nfunction isVideoFile(fileName: string): boolean {\n  const videoExtensions = [\n    \".mp4\",\n    \".avi\",\n    \".mov\",\n    \".mkv\",\n    \".wmv\",\n    \".flv\",\n    \".webm\",\n    \".ts\",\n  ];\n  const lowerCaseFileName = fileName.toLowerCase();\n\n  return videoExtensions.some((ext) => lowerCaseFileName.endsWith(ext));\n}\n\nexport {\n  isNumber,\n  isString,\n  isBool,\n  isVec2,\n  isVec3,\n  isVec4,\n  isImageFile,\n  isVideoFile,\n};\n","import type { UniformType } from \"./types\";\nimport { isImageFile, isVideoFile } from \"./validators\";\n\nfunction getContext(canvas: HTMLCanvasElement) {\n  const gl = canvas.getContext(\"webgl\");\n\n  if (!gl) throw new Error(\"WebGL not supported\");\n\n  return gl;\n}\n\nfunction updateTexture(\n  gl: WebGLRenderingContext,\n  texture?: HTMLImageElement | HTMLVideoElement\n) {\n  const { TEXTURE_2D, RGBA, UNSIGNED_BYTE } = gl;\n  const pixel = new Uint8Array([0, 0, 0, 255]);\n\n  if (!texture) {\n    gl.texImage2D(TEXTURE_2D, 0, RGBA, 1, 1, 0, RGBA, UNSIGNED_BYTE, pixel);\n  } else {\n    gl.texImage2D(gl.TEXTURE_2D, 0, RGBA, RGBA, UNSIGNED_BYTE, texture);\n  }\n}\n\nfunction setTextureParams(\n  gl: WebGLRenderingContext,\n  texture: HTMLImageElement | HTMLVideoElement\n) {\n  if (isPowerOf2(texture.width) && isPowerOf2(texture.height)) {\n    // Set parameters for power-of-2 textures\n    gl.generateMipmap(gl.TEXTURE_2D);\n  } else {\n    // Set parameters for non-power-of-2 textures\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  }\n}\n\n// Helper function to check if a number is a power of 2\nfunction isPowerOf2(value: number): boolean {\n  return value > 0 && (value & (value - 1)) === 0;\n}\n\ninterface ValidInferredUniform {\n  valid: true;\n  type: UniformType;\n}\n\ninterface InvalidInferredUniform {\n  valid: false;\n  message: string;\n}\n\ntype InferredUniform = ValidInferredUniform | InvalidInferredUniform;\n\nfunction getUniformType(uniform: unknown): InferredUniform {\n  if (typeof uniform === \"string\") {\n    if (isImageFile(uniform)) {\n      return { valid: true, type: \"image\" };\n    } else if (isVideoFile(uniform)) {\n      return { valid: true, type: \"video\" };\n    } else if (uniform === \"webcam\") {\n      return { valid: true, type: \"webcam\" };\n    } else if (!isNaN(Number(uniform)) && uniform.includes(\".\")) {\n      return { valid: true, type: \"float\" };\n    } else if (!isNaN(Number(uniform)) && !uniform.includes(\".\")) {\n      return { valid: true, type: \"int\" };\n    } else {\n      return { valid: false, message: `Unknown uniform type: ${uniform}` };\n    }\n  } else if (Array.isArray(uniform)) {\n    if (uniform.length >= 2 && uniform.length <= 4) {\n      const type = `vec${uniform.length}` as \"vec2\" | \"vec3\" | \"vec4\";\n      return { valid: true, type };\n    } else {\n      return {\n        valid: false,\n        message: `Invalid vector length: ${uniform.length}`,\n      };\n    }\n  } else if (typeof uniform === \"number\") {\n    return { valid: true, type: \"float\" };\n  } else if (typeof uniform === \"boolean\") {\n    return { valid: true, type: \"bool\" };\n  } else {\n    return { valid: false, message: `Unknown uniform type: ${uniform}` };\n  }\n}\n\nexport { getContext, updateTexture, setTextureParams, getUniformType };\n","import { getUniformType, setTextureParams, updateTexture } from \"./utils\";\nimport type { UniformType, UniformValue, UniformMap } from \"./types\";\nimport {\n  isBool,\n  isNumber,\n  isString,\n  isVec2,\n  isVec3,\n  isVec4,\n} from \"./validators\";\n\ninterface WebGLUniform {\n  type: UniformType;\n  location: WebGLUniformLocation;\n}\n\ninterface StaticTexture {\n  asset: WebGLTexture;\n  unit: number;\n}\n\ninterface DynamicTexture extends StaticTexture {\n  video: HTMLVideoElement;\n}\n\nclass GlslAssetManager {\n  readonly gl: WebGLRenderingContext;\n  readonly program: WebGLProgram;\n  readonly uniforms: Map<string, WebGLUniform> = new Map();\n  readonly staticTextures: Map<string, StaticTexture> = new Map();\n  readonly dynamicTextures: Map<string, DynamicTexture> = new Map();\n  readonly uniformPrefix: string = \"u_\";\n\n  constructor(\n    gl: WebGLRenderingContext,\n    program: WebGLProgram,\n    initialUniforms: UniformMap,\n    uniformPrefix: string\n  ) {\n    this.gl = gl;\n    this.program = program;\n    this.uniformPrefix = uniformPrefix;\n\n    this.initializeDefaultUniforms();\n    this.initializeCustomUniforms(initialUniforms);\n  }\n\n  // UNIFORM METHODS ----------------------------------------------------\n\n  private initializeDefaultUniforms() {\n    const uTime = this.gl.getUniformLocation(\n      this.program,\n      `${this.uniformPrefix}time`\n    );\n    if (uTime) {\n      this.uniforms.set(`${this.uniformPrefix}time`, {\n        type: \"float\",\n        location: uTime,\n      });\n    }\n\n    const uRes = this.gl.getUniformLocation(\n      this.program,\n      `${this.uniformPrefix}resolution`\n    );\n    if (uRes) {\n      this.uniforms.set(`${this.uniformPrefix}resolution`, {\n        type: \"vec2\",\n        location: uRes,\n      });\n    }\n\n    const uMouse = this.gl.getUniformLocation(\n      this.program,\n      `${this.uniformPrefix}mouse`\n    );\n    if (uMouse) {\n      this.uniforms.set(`${this.uniformPrefix}mouse`, {\n        type: \"vec2\",\n        location: uMouse,\n      });\n    }\n  }\n\n  private initializeCustomUniforms(uniforms: UniformMap) {\n    for (const [name, val] of Object.entries(uniforms)) {\n      const location = this.gl.getUniformLocation(\n        this.program,\n        `${this.uniformPrefix}${name}`\n      );\n      if (!location) {\n        console.warn(`Couldn't init uniform (${name}). Did you set it?`);\n        continue;\n      }\n\n      const inferred = getUniformType(val);\n\n      if (!inferred.valid) {\n        console.error(inferred.message);\n        continue;\n      }\n\n      this.uniforms.set(name, { type: inferred.type, location });\n\n      this.setUniformValue(name, val);\n    }\n  }\n\n  public setUniformValue(_name: string, value: UniformValue) {\n    const uni = this.uniforms.get(_name);\n    if (!uni) {\n      console.warn(`Uniform ${_name} not found`);\n      return;\n    }\n\n    const name = `${this.uniformPrefix}${_name}`;\n\n    const { type, location } = uni;\n\n    switch (type) {\n      case \"float\":\n        if (isNumber(value)) this.gl.uniform1f(location, value);\n        else console.warn(`Couldn't update ${name}, value must be a number`);\n        break;\n\n      case \"vec2\":\n        if (isVec2(value)) this.gl.uniform2fv(location, value);\n        else console.warn(`Couldn't update ${name}, value must be a Vec2`);\n        break;\n\n      case \"vec3\":\n        if (isVec3(value)) this.gl.uniform3fv(location, value);\n        else console.warn(`Couldn't update ${name}, value must be a Vec3`);\n        break;\n\n      case \"vec4\":\n        if (isVec4(value)) this.gl.uniform4fv(location, value);\n        else console.warn(`Couldn't update ${name}, value must be a Vec4`);\n        break;\n\n      case \"int\":\n        if (isNumber(value)) this.gl.uniform1i(location, value);\n        else console.warn(`Couldn't update ${name}, value must be a number`);\n        break;\n\n      case \"bool\":\n        if (isBool(value)) this.gl.uniform1i(location, value ? 1 : 0);\n        else console.warn(`Couldn't update ${name}, value must be a boolean`);\n        break;\n\n      case \"image\":\n        if (isString(value)) this.loadStaticTexture(name, value);\n        else console.warn(`Couldn't update ${name}, value must be a string`);\n        break;\n\n      case \"video\":\n        if (isString(value)) this.loadDynamicTexture(name, value);\n        else console.warn(`Couldn't update ${name}, value must be a string`);\n        break;\n\n      case \"webcam\":\n        this.loadDynamicTexture(name);\n        break;\n\n      default:\n        console.warn(`Unsupported uniform type for ${name}`);\n    }\n  }\n\n  // TEXTURE METHODS ----------------------------------------------------\n\n  private getTextureUnit() {\n    return this.staticTextures.size + this.dynamicTextures.size;\n  }\n\n  private getUniformLocation(name: string) {\n    const location = this.gl.getUniformLocation(this.program, name);\n    if (!location) {\n      throw new Error(`Failed to retrieve unform loaction for ${name}`);\n    }\n    return location;\n  }\n\n  private initializeTexture(name: string) {\n    // Create a new texture\n    const location = this.getUniformLocation(name);\n    const texture = this.gl.createTexture();\n    const textureUnit = this.getTextureUnit();\n\n    // Set the sampler uniform to use the correct texture unit\n    this.gl.uniform1i(location, textureUnit);\n\n    // Use a placeholder pixel while the image loads\n    this.gl.activeTexture(this.gl.TEXTURE0 + textureUnit);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\n    updateTexture(this.gl);\n\n    return [texture, textureUnit] as const;\n  }\n\n  private loadStaticTexture(name: string, url: string) {\n    const [texture, textureUnit] = this.initializeTexture(name);\n\n    // Track the texture\n    this.staticTextures.set(name, { asset: texture, unit: textureUnit });\n\n    // Load the image\n    const image = new Image();\n    image.crossOrigin = \"anonymous\";\n\n    image.onload = () => {\n      try {\n        const texture = this.staticTextures.get(name);\n        const sizeName = `${name}_size`;\n        const sizeLocation = this.gl.getUniformLocation(this.program, sizeName);\n\n        if (sizeLocation && texture) {\n          this.uniforms.set(sizeName, { type: \"vec2\", location: sizeLocation });\n          this.gl.uniform2f(sizeLocation, image.width, image.height);\n          this.gl.activeTexture(this.gl.TEXTURE0 + texture.unit);\n          this.gl.bindTexture(this.gl.TEXTURE_2D, texture.asset);\n          setTextureParams(this.gl, image);\n          updateTexture(this.gl, image);\n        }\n      } catch (error) {\n        console.error(`Error loading texture ${name}:`, error);\n      }\n    };\n\n    image.onerror = () => {\n      console.error(`Failed to load texture: ${url}`);\n    };\n\n    image.src = url;\n  }\n\n  private async loadDynamicTexture(name: string, url?: string) {\n    const video = document.createElement(\"video\");\n    video.muted = true;\n    video.autoplay = true;\n    video.playsInline = true;\n\n    video.onloadeddata = () => {\n      const [asset, unit] = this.initializeTexture(name);\n\n      // Track the texture\n      this.dynamicTextures.set(name, { video, asset, unit });\n\n      video.play();\n\n      try {\n        const texture = this.dynamicTextures.get(name);\n        const sizeName = `${name}_size`;\n        const sizeLocation = this.gl.getUniformLocation(this.program, sizeName);\n\n        if (sizeLocation && texture) {\n          this.uniforms.set(sizeName, { type: \"vec2\", location: sizeLocation });\n          this.gl.uniform2f(sizeLocation, video.videoWidth, video.videoHeight);\n          this.gl.activeTexture(this.gl.TEXTURE0 + texture.unit);\n          this.gl.bindTexture(this.gl.TEXTURE_2D, texture.asset);\n          setTextureParams(this.gl, texture.video);\n          updateTexture(this.gl, texture.video);\n        }\n      } catch (error) {\n        console.error(`Error loading texture ${name}:`, error);\n      }\n    };\n\n    video.onerror = () => {\n      console.error(`Failed to load texture: ${url}`);\n    };\n\n    if (!url) {\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n      video.srcObject = stream;\n    } else {\n      video.loop = true;\n      video.crossOrigin = \"anonymous\";\n      video.src = url;\n    }\n  }\n\n  public renderDynamicTextures() {\n    for (const texture of Array.from(this.dynamicTextures.values())) {\n      this.gl.activeTexture(this.gl.TEXTURE0 + texture.unit);\n      this.gl.bindTexture(this.gl.TEXTURE_2D, texture.asset);\n      this.gl.texImage2D(\n        this.gl.TEXTURE_2D,\n        0,\n        this.gl.RGBA,\n        this.gl.RGBA,\n        this.gl.UNSIGNED_BYTE,\n        texture.video\n      );\n    }\n  }\n\n  // LIFECYCLE METHODS ----------------------------------------------------\n\n  public destroy() {\n    this.staticTextures.forEach((txtr) => this.gl.deleteTexture(txtr.asset));\n    this.staticTextures.clear();\n    for (const texture of Array.from(this.dynamicTextures.values())) {\n      const src = texture.video.srcObject;\n      if (src instanceof MediaStream) {\n        src.getTracks().forEach((track) => track.stop());\n      } else {\n        texture.video.srcObject = null;\n      }\n    }\n    this.dynamicTextures.clear();\n  }\n}\n\nexport default GlslAssetManager;\n","const vertexShaderSource = `\n    attribute vec2 a_position;\n    void main() {\n      gl_Position = vec4(a_position, 0.0, 1.0);\n    }\n  `;\n\nconst fragmentShaderSource = `\n    #ifdef GL_ES\n    precision mediump float;\n    #endif\n\n    uniform float u_time;\n    uniform vec2 u_resolution;\n    uniform vec2 u_mouse;\n\n    void main() {\n      vec2 st = gl_FragCoord.xy / u_resolution;\n      vec2 mouse = u_mouse / u_resolution;\n\n      // Distance from the mouse\n      float dist = distance(st, mouse);\n      \n      // Color based on time and distance\n      vec3 color = vec3(0.5 + 0.5 * cos(u_time + dist * 10.0), dist, st.x);\n      gl_FragColor = vec4(color, 1.0);\n    }\n  `;\n\nexport { vertexShaderSource, fragmentShaderSource };\n","import { getContext } from \"./utils\";\nimport { fragmentShaderSource, vertexShaderSource } from \"./shaders\";\n\nconst DEFAULT_VERTICES = new Float32Array([\n  -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1,\n]);\n\nclass GlslCanvas {\n  readonly container: HTMLElement;\n  readonly canvas: HTMLCanvasElement;\n  readonly gl: WebGLRenderingContext;\n  readonly program: WebGLProgram;\n\n  constructor(container: HTMLElement, frag?: string) {\n    this.container = container;\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.style.display = \"block\";\n    this.canvas.style.width = this.canvas.style.height = \"100%\";\n    this.container.appendChild(this.canvas);\n\n    this.gl = getContext(this.canvas);\n\n    const vertexShader = this.compileShader(\n      this.gl.VERTEX_SHADER,\n      vertexShaderSource\n    );\n\n    const fragmentShader = this.compileShader(\n      this.gl.FRAGMENT_SHADER,\n      frag ?? fragmentShaderSource\n    );\n\n    this.program = this.createProgram(vertexShader, fragmentShader);\n    this.gl.useProgram(this.program);\n    this.createBuffer(DEFAULT_VERTICES);\n\n    const a_Position = this.gl.getAttribLocation(this.program, \"a_position\");\n    this.gl.enableVertexAttribArray(a_Position);\n    this.gl.vertexAttribPointer(a_Position, 2, this.gl.FLOAT, false, 0, 0);\n  }\n\n  private compileShader(type: number, source: string) {\n    const shader = this.gl.createShader(type);\n    if (!shader) throw new Error(\"Shader creation failed\");\n\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n\n    if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      this.gl.deleteShader(shader);\n      throw new Error(\n        `Shader compilation error: ${this.gl.getShaderInfoLog(shader)}`\n      );\n    }\n\n    return shader;\n  }\n\n  private createProgram(\n    vertexShader: WebGLShader,\n    fragmentShader: WebGLShader\n  ) {\n    const program = this.gl.createProgram();\n    if (!program) {\n      throw new Error(`Error creating WebGL Program`);\n    }\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n    this.gl.linkProgram(program);\n    if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n      throw new Error(\n        `Program linking error: ${this.gl.getProgramInfoLog(program)}`\n      );\n    }\n    return program;\n  }\n\n  private createBuffer(data: Float32Array) {\n    const buffer = this.gl.createBuffer();\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, buffer);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, data, this.gl.STATIC_DRAW);\n    return buffer;\n  }\n\n  public resizeCanvas() {\n    const rect = this.container.getBoundingClientRect();\n    this.canvas.width = rect.width;\n    this.canvas.height = rect.height;\n  }\n\n  public destroy() {\n    this.container.innerHTML = \"\";\n  }\n}\n\nexport default GlslCanvas;\nexport { DEFAULT_VERTICES };\n","import GlslAssetManager from \"./glsl-asset-manager\";\nimport GlslCanvas, { DEFAULT_VERTICES } from \"./glsl-canvas\";\nimport type { UniformValue, UniformMap } from \"./types\";\n\ninterface GlslRendererConstructorProps {\n  container: HTMLElement;\n  frag?: string;\n  uniforms?: UniformMap;\n  uniformPrefix?: string;\n}\n\nexport default class GlslRenderer extends GlslCanvas {\n  private mousePos = [0, 0];\n  private controller = new AbortController();\n  private rafId: number | null = null;\n  readonly assets: GlslAssetManager;\n\n  constructor({\n    container,\n    frag,\n    uniforms = {},\n    uniformPrefix = \"u_\",\n  }: GlslRendererConstructorProps) {\n    super(container, frag);\n    this.assets = new GlslAssetManager(\n      this.gl,\n      this.program,\n      uniforms,\n      uniformPrefix\n    );\n\n    this.handleResize();\n    this.addEventListeners();\n  }\n\n  private render(time: number) {\n    this.gl.clearColor(0, 0, 0, 1);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n\n    // Pass uniforms\n    const uTime = this.assets.uniforms.get(`${this.assets.uniformPrefix}time`);\n    if (uTime) {\n      this.gl.uniform1f(uTime.location, time * 0.001); // Time in seconds\n    }\n    const uMouse = this.assets.uniforms.get(\n      `${this.assets.uniformPrefix}mouse`\n    );\n    if (uMouse) {\n      this.gl.uniform2f(uMouse.location, this.mousePos[0], this.mousePos[1]);\n    }\n\n    // render dynamic textures\n    this.assets.renderDynamicTextures();\n\n    // Draw\n    this.gl.drawArrays(this.gl.TRIANGLES, 0, DEFAULT_VERTICES.length / 2);\n\n    requestAnimationFrame((t) => this.render(t));\n  }\n\n  private handleResize() {\n    super.resizeCanvas();\n\n    const uRes =\n      this.assets.uniforms.get(`${this.assets.uniformPrefix}resolution`) ??\n      null;\n\n    if (!uRes) {\n      console.warn(\n        `Could not find resolution uniform (${this.assets.uniformPrefix}resolution) location when resizing canvas`\n      );\n      return;\n    }\n\n    this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\n    this.gl.uniform2f(uRes.location, this.canvas.width, this.canvas.height);\n  }\n\n  private addEventListeners() {\n    const { signal } = this.controller;\n\n    this.canvas.addEventListener(\n      \"mousemove\",\n      (event) => {\n        const rect = this.canvas.getBoundingClientRect();\n        this.mousePos[0] = event.clientX - rect.left;\n        this.mousePos[1] = rect.height - (event.clientY - rect.top); // Flip Y-axis\n      },\n      { signal }\n    );\n\n    this.canvas.addEventListener(\n      \"touchmove\",\n      (event) => {\n        const { clientX, clientY } = event.touches[0];\n        const rect = this.canvas.getBoundingClientRect();\n        this.mousePos[0] = clientX - rect.left;\n        this.mousePos[1] = rect.height - (clientY - rect.top); // Flip Y-axis\n      },\n      { signal }\n    );\n\n    window.addEventListener(\"resize\", () => this.handleResize(), { signal });\n  }\n\n  public play() {\n    this.rafId = requestAnimationFrame((t) => this.render(t));\n  }\n\n  public pause() {\n    if (typeof this.rafId === \"number\") {\n      cancelAnimationFrame(this.rafId);\n      this.rafId = null;\n    }\n  }\n\n  public updateUniform(name: string, value: UniformValue) {\n    this.assets.setUniformValue(name, value);\n  }\n\n  public destroy() {\n    super.destroy();\n    this.assets.destroy();\n    this.controller.abort();\n  }\n}\n"]}